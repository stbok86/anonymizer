#!/usr/bin/env python3
# -*- coding: utf-8 -*-
"""
–î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è —Ä–∞–±–æ—Ç—ã –¥–µ—Ç–µ–∫—Ü–∏–∏ –ø–æ–ª–Ω—ã—Ö –Ω–∞–∑–≤–∞–Ω–∏–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Å–∏—Å—Ç–µ–º
–ü—Ä–æ—Å—Ç–æ–µ –æ–±—ä—è—Å–Ω–µ–Ω–∏–µ –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤ –∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
"""

import sys
sys.path.append('nlp_service/app')

from nlp_adapter import NLPAdapter
from information_system_strategy import InformationSystemStrategy
import json

def demonstrate_full_name_detection():
    """–î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è –¥–µ—Ç–µ–∫—Ü–∏–∏ –ø–æ–ª–Ω—ã—Ö –Ω–∞–∑–≤–∞–Ω–∏–π –ò–°"""
    
    print("üéØ –î–ï–¢–ï–ö–¶–ò–Ø –ü–û–õ–ù–´–• –ù–ê–ó–í–ê–ù–ò–ô –ò–ù–§–û–†–ú–ê–¶–ò–û–ù–ù–´–• –°–ò–°–¢–ï–ú")
    print("=" * 60)
    
    # –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
    adapter = NLPAdapter()
    with open('nlp_service/config/nlp_config.json', 'r', encoding='utf-8') as f:
        config = json.load(f)
    strategy_config = config['nlp_service_config']['detection_methods']['information_system']
    strategy = InformationSystemStrategy(strategy_config)
    
    # –ü—Ä–∏–º–µ—Ä—ã —Ç–µ–∫—Å—Ç–æ–≤ –¥–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏
    test_cases = [
        {
            'name': '–ü—Ä–æ—Å—Ç–æ–µ –ø–æ–ª–Ω–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ',
            'text': '–ï–¥–∏–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è',
            'description': '–ë–∞–∑–æ–≤—ã–π —Å–ª—É—á–∞–π - –Ω–∞—Ö–æ–¥–∏—Ç "–ï–¥–∏–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞"'
        },
        {
            'name': '–° –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–º –æ–ø–∏—Å–∞–Ω–∏–µ–º',
            'text': '–ï–¥–∏–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ñ–∏–Ω–∞–Ω—Å–æ–≤–æ-—Ö–æ–∑—è–π—Å—Ç–≤–µ–Ω–Ω–æ–π –¥–µ—è—Ç–µ–ª—å–Ω–æ—Å—Ç—å—é –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω–∞ –¥–ª—è —Ä–∞–±–æ—Ç—ã',
            'description': '–°–ª–æ–∂–Ω—ã–π —Å–ª—É—á–∞–π - –Ω–∞—Ö–æ–¥–∏—Ç –ø–æ–ª–Ω–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ —Å –æ–ø–∏—Å–∞–Ω–∏–µ–º –æ–±–ª–∞—Å—Ç–∏ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è'
        },
        {
            'name': '–í —Ä–∞–∑–Ω—ã—Ö –ø–∞–¥–µ–∂–∞—Ö',
            'text': '–ü–æ–¥—Å–∏—Å—Ç–µ–º–∞ –µ–¥–∏–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã —Å–æ–¥–µ—Ä–∂–∏—Ç –¥–∞–Ω–Ω—ã–µ',
            'description': '–°–∫–ª–æ–Ω–µ–Ω–∏–µ - –Ω–∞—Ö–æ–¥–∏—Ç —Å–∏—Å—Ç–µ–º—É –≤ —Ä–æ–¥–∏—Ç–µ–ª—å–Ω–æ–º –ø–∞–¥–µ–∂–µ'
        },
        {
            'name': '–ì–æ—Å—É–¥–∞—Ä—Å—Ç–≤–µ–Ω–Ω–∞—è –ò–°',
            'text': '–ì–æ—Å—É–¥–∞—Ä—Å—Ç–≤–µ–Ω–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –∫–æ–Ω—Ç—Ä–æ–ª—å',
            'description': '–î—Ä—É–≥–æ–π —Ç–∏–ø - –≥–æ—Å—É–¥–∞—Ä—Å—Ç–≤–µ–Ω–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞'
        }
    ]
    
    for i, test_case in enumerate(test_cases, 1):
        print(f"\nüìã –¢–µ—Å—Ç {i}: {test_case['name']}")
        print(f"üìù –û–ø–∏—Å–∞–Ω–∏–µ: {test_case['description']}")
        print(f"üîç –¢–µ–∫—Å—Ç: '{test_case['text']}'")
        
        # –í—ã–ø–æ–ª–Ω—è–µ–º –¥–µ—Ç–µ–∫—Ü–∏—é
        entities = strategy.detect_information_systems_in_text(test_case['text'])
        
        print(f"üìä –†–µ–∑—É–ª—å—Ç–∞—Ç: –Ω–∞–π–¥–µ–Ω–æ {len(entities)} —Å—É—â–Ω–æ—Å—Ç–µ–π")
        
        for j, entity in enumerate(entities):
            if entity.get('method') == 'information_system_regex':
                print(f"  ‚úÖ –ü–æ–ª–Ω–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ {j+1}:")
                print(f"    üìã –û—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ: '{entity['original_value']}'")
                print(f"    üîß –û–±—â–∞—è —á–∞—Å—Ç—å: '{entity.get('core_part', '–ù–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∞')}'")
                print(f"    üîí –ü—Ä–∏–≤–∞—Ç–Ω–∞—è —á–∞—Å—Ç—å: '{entity.get('private_part', '–û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç')}'")
                print(f"    üéØ –ê–Ω–æ–Ω–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π: '{entity.get('anonymized_text', '–û—à–∏–±–∫–∞')}'")
                print(f"    üìç –ü–æ–∑–∏—Ü–∏—è: {entity['position']['start']}-{entity['position']['end']}")
                print(f"    üé≤ –£–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å: {entity['confidence']}")

if __name__ == "__main__":
    demonstrate_full_name_detection()