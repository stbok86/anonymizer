#!/usr/bin/env python3
"""
–ü–æ–¥—Ä–æ–±–Ω—ã–π –∞–Ω–∞–ª–∏–∑ government_org –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤
"""
import pandas as pd
import os
import re

def analyze_government_org_patterns():
    # –ü—É—Ç—å –∫ Excel —Ñ–∞–π–ª—É
    excel_path = os.path.join(os.path.dirname(__file__), "nlp_patterns.xlsx")
    
    try:
        df = pd.read_excel(excel_path)
        print("üèõÔ∏è –ê–ù–ê–õ–ò–ó –ü–ê–¢–¢–ï–†–ù–û–í GOVERNMENT_ORG")
        print("=" * 50)
        
        # –§–∏–ª—å—Ç—Ä—É–µ–º —Ç–æ–ª—å–∫–æ government_org –ø–∞—Ç—Ç–µ—Ä–Ω—ã
        gov_patterns = df[df['category'] == 'government_org']
        
        for idx, row in gov_patterns.iterrows():
            print(f"\nüìã –ü–∞—Ç—Ç–µ—Ä–Ω #{idx+1}")
            print(f"   –û–ø–∏—Å–∞–Ω–∏–µ: {row['description']}")
            print(f"   –†–µ–≥—É–ª—è—Ä–Ω–æ–µ –≤—ã—Ä–∞–∂–µ–Ω–∏–µ: {row['pattern']}")
            print(f"   –£–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å: {row['confidence']}")
            print(f"   –¢–∏–ø: {row['pattern_type']}")
            print(f"   –ö–æ–Ω—Ç–µ–∫—Å—Ç —Ç—Ä–µ–±—É–µ—Ç—Å—è: {row['context_required']}")
            
            # –¢–µ—Å—Ç–∏—Ä—É–µ–º –ø–∞—Ç—Ç–µ—Ä–Ω –Ω–∞ –ø—Ä–∏–º–µ—Ä–∞—Ö
            pattern = row['pattern']
            test_examples = [
                "–ú–∏–Ω–∏—Å—Ç–µ—Ä—Å—Ç–≤–æ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω–æ–≥–æ —Ä–∞–∑–≤–∏—Ç–∏—è –∏ —Å–≤—è–∑–∏ –ü–µ—Ä–º—Å–∫–æ–≥–æ –∫—Ä–∞—è",
                "–î–µ–ø–∞—Ä—Ç–∞–º–µ–Ω—Ç –æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—è –ú–æ—Å–∫–≤—ã",
                "–§–µ–¥–µ—Ä–∞–ª—å–Ω–∞—è —Å–ª—É–∂–±–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –†–§",
                "–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏—Ö –¥–µ–ª –ø–æ –°–≤–µ—Ä–¥–ª–æ–≤—Å–∫–æ–π –æ–±–ª–∞—Å—Ç–∏",
                "–ö–æ–º–∏—Ç–µ—Ç –ø–æ –æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏—é –°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥–∞",
                "–ú–∏–Ω–∏—Å—Ç–µ—Ä—Å—Ç–≤–æ –∑–¥—Ä–∞–≤–æ–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –†–§",
                "–ú–∏–Ω–∏—Å—Ç–µ—Ä—Å—Ç–≤–æ –æ–±–æ—Ä–æ–Ω—ã –†–æ—Å—Å–∏–∏",
                "–§–µ–¥–µ—Ä–∞–ª—å–Ω–æ–µ –∞–≥–µ–Ω—Ç—Å—Ç–≤–æ –ø–æ —Ç—É—Ä–∏–∑–º—É"
            ]
            
            print(f"   üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:")
            try:
                compiled_pattern = re.compile(pattern, re.IGNORECASE)
                matches_found = 0
                for example in test_examples:
                    match = compiled_pattern.search(example)
                    if match:
                        matches_found += 1
                        print(f"      ‚úÖ '{example}' ‚Üí '{match.group()}'")
                    else:
                        print(f"      ‚ùå '{example}' ‚Üí –Ω–µ—Ç —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è")
                
                print(f"   üìä –†–µ–∑—É–ª—å—Ç–∞—Ç: {matches_found}/{len(test_examples)} —Å–æ–≤–ø–∞–¥–µ–Ω–∏–π")
                
            except re.error as e:
                print(f"      ‚ö†Ô∏è –û—à–∏–±–∫–∞ –≤ —Ä–µ–≥–µ–∫—Å–µ: {e}")
        
        # –ê–Ω–∞–ª–∏–∑ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –∞–ª–≥–æ—Ä–∏—Ç–º–æ–≤
        print(f"\nüìà –ê–ù–ê–õ–ò–ó –ê–õ–ì–û–†–ò–¢–ú–ê –î–ï–¢–ï–ö–¶–ò–ò")
        print("=" * 50)
        
        total_patterns = len(gov_patterns)
        regex_patterns = len(gov_patterns[gov_patterns['pattern_type'] == 'regex'])
        high_confidence = len(gov_patterns[gov_patterns['confidence'] >= 0.8])
        context_required = len(gov_patterns[gov_patterns['context_required'] == True])
        
        print(f"üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:")
        print(f"   –í—Å–µ–≥–æ –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤: {total_patterns}")
        print(f"   Regex –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤: {regex_patterns}")
        print(f"   –í—ã—Å–æ–∫–∞—è —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å (‚â•0.8): {high_confidence}")
        print(f"   –¢—Ä–µ–±—É—é—Ç –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞: {context_required}")
        
        print(f"\nüéØ –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ –∞–ª–≥–æ—Ä–∏—Ç–º–∞:")
        print(f"   - –§–æ–∫—É—Å –Ω–∞ —Ñ–µ–¥–µ—Ä–∞–ª—å–Ω—ã—Ö –∏ —Ä–µ–≥–∏–æ–Ω–∞–ª—å–Ω—ã—Ö –æ—Ä–≥–∞–Ω–∞—Ö –≤–ª–∞—Å—Ç–∏")
        print(f"   - –ü–æ–∫—Ä—ã—Ç–∏–µ –º–∏–Ω–∏—Å—Ç–µ—Ä—Å—Ç–≤, –¥–µ–ø–∞—Ä—Ç–∞–º–µ–Ω—Ç–æ–≤, —Å–ª—É–∂–± –∏ –∞–≥–µ–Ω—Ç—Å—Ç–≤")
        print(f"   - –£—á–µ—Ç —Ä–µ–≥–∏–æ–Ω–∞–ª—å–Ω–æ–π —Å–ø–µ—Ü–∏—Ñ–∏–∫–∏ (–∫—Ä–∞—è, –æ–±–ª–∞—Å—Ç–∏, —Ä–µ—Å–ø—É–±–ª–∏–∫–∏)")
        print(f"   - –°—Ä–µ–¥–Ω–∏–π —É—Ä–æ–≤–µ–Ω—å —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç–∏: {gov_patterns['confidence'].mean():.2f}")
        
        # –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ —É–ª—É—á—à–µ–Ω–∏—é
        print(f"\nüí° –†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–ò –ü–û –£–õ–£–ß–®–ï–ù–ò–Æ:")
        print("=" * 50)
        print("   1. –î–æ–±–∞–≤–∏—Ç—å –ø–æ–¥–¥–µ—Ä–∂–∫—É –º—É–Ω–∏—Ü–∏–ø–∞–ª—å–Ω—ã—Ö –æ—Ä–≥–∞–Ω–æ–≤ –≤–ª–∞—Å—Ç–∏")
        print("   2. –£—á–µ—Å—Ç—å –≤–∞—Ä–∏–∞—Ü–∏–∏ –Ω–∞–ø–∏—Å–∞–Ω–∏—è (—Å–æ–∫—Ä–∞—â–µ–Ω–∏—è)")
        print("   3. –î–æ–±–∞–≤–∏—Ç—å –∫–æ–Ω—Ç–µ–∫—Å—Ç–Ω—ã–µ —Å–ª–æ–≤–∞-–º–∞—Ä–∫–µ—Ä—ã")
        print("   4. –†–∞—Å—à–∏—Ä–∏—Ç—å –ø–æ–∫—Ä—ã—Ç–∏–µ —Ä–µ–≥–∏–æ–Ω–∞–ª—å–Ω—ã—Ö —Å—Ç—Ä—É–∫—Ç—É—Ä")
        print("   5. –î–æ–±–∞–≤–∏—Ç—å NLP-–º–µ—Ç–æ–¥—ã –Ω–∞—Ä—è–¥—É —Å regex")
        
    except Exception as e:
        print(f"‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ –∞–Ω–∞–ª–∏–∑–µ: {e}")

if __name__ == "__main__":
    analyze_government_org_patterns()